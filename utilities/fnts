const fn = {
  copyText(text: string) {
    const { clipboard } = navigator;
    /** æ–°å¼å†™æ³• */
    if (clipboard && clipboard.writeText) {
      clipboard.writeText(text);
    } else if ((window as any).clipboardData) {
      /*IE å¤§å“¥*/
      (window as any).clipboardData.clearData();
      (window as any).clipboardData.setData('Text', text);
    } else if (document.execCommand) {
      /*  æ—§å¼å†™æ³•*/
      const hover = document.createElement('input');
      hover.value = text;
      document.body.appendChild(hover);
      hover.select();
      document.execCommand('Copy');
      hover.className = 'hover';
      hover.style.display = 'none';
    }
  },

  tendTiZero(data: number, step: number = 1) {
    if (data > step) return data - step;
    else if (-data > step) return data + step;
    else return 0;
  },
};
/**  æ’å…¥æ’åº */
function insertSortFunction(arr: any[], asc: boolean = true): number {
  let cum = 0,
    l = arr.length; // å®šä¹‰äº¤æ¢æ•°æ®æ¬¡æ•°
  if (l > 1)
    // å¦‚æœæ•°æ®é•¿åº¦æ•ˆç›Š 1 ç›´æ¥è¿”å›
    for (
      let i = 1;
      i < l;
      i++ // æœ€å¤–å±‚æ¯”å¯¹ç¬¬ i ä¸ªå…ƒç´ 
    )
      for (let m = i + 1; --m; ) {
        // å†…å±‚å°†æ•°æ®å‰ç§»ï¼Œå‘å‰æ¯”å¯¹
        if ((asc && arr[m] < arr[m - 1]) || (!asc && arr[m] > arr[m - 1]))
          // å‰é¢å·²ç»æ’å¥½é˜Ÿäº†ï¼Œå¦‚æœå¤§äºå‰é¢å°±å¯ä»¥ç›´æ¥é€€å‡ºå†…å¾ªç¯
          (arr[m] = [arr[m - 1], (arr[m - 1] = arr[m])][0]), cum++;
        // æ•°æ®äº¤æ¢ï¼Œå¹¶å¢åŠ è®¡æ•°å™¨
        else break;
      }
  return cum;
}
/** å¸Œå°”æ’åº */
function shellSortFunction(arr: any[], asc: boolean = true): any {
  let cum = 0,
    l = arr.length;
  if (l > 1)
    //  æ‹¿åˆ°ä¸€åŠçš„ä½ç½® ,å°†è¿™ä¸ªå€¼ä½œä¸ºæ¯æ¬¡æŠ˜ä¸­çš„å»å–å€¼
    for (let i = Math.floor(l / 2); i > 0; i = Math.floor(i / 2))
      // å®šä¹‰åŒºé—´å˜é‡ï¼Œä»è¿™ä¸ªå˜é‡å¼€å§‹æ’åº
      for (let j = i; j < l; j += i)
        // ä¸å‰é¢è¿›è¡Œæ¯”è¾ƒ
        for (
          let m = j - i;
          m >= 0 &&
          ((asc && arr[m] > arr[i + m]) || (!asc && arr[m] < arr[i + m]));
          m -= i
        )
          (arr[m] = [arr[i + m], (arr[i + m] = arr[m])][0]), cum++; // æ›¿æ¢å…ƒç´ å¹¶è®¡æ•°å™¨è‡ªå¢
  return cum;
}

/** å½’å¹¶æ’åº */
function mergeSortFunction(arr: any, cumNum: number = 0): any {
  let cum = { cum: cumNum }; // è®¡æ•°å™¨
  if (arr.length < 2)
    // å½“åˆ†åˆ°æœ€åï¼Œç›´æ¥è¿”å›å…ƒç´ æœ¬èº«
    return [0, arr];
  var middle = Math.floor(arr.length / 2), // æ•°å€¼ä¸­å€¼
    left = arr.slice(0, middle), // æ•°ç»„å·¦ä¸€åŠ
    right = arr.slice(middle); //  æ•°ç»„å³ä¸€åŠ
  const result = [],
    [leftCum, leftTemp] = mergeSortFunction(left, cum.cum),
    [rightCum, rightTemp] = mergeSortFunction(right, cum.cum); // æ¯æ¬¡çš„ç»“æœ
  cum.cum = cum.cum + leftCum + rightCum; // è®¡æ•°å™¨
  while (leftTemp.length > 0 && rightTemp.length > 0)
    // ä¸¤ä¸ªæ•°ç»„å¿…é¡»éƒ½æœ‰å…ƒç´ æ‰å¯ä»¥æ¯”å¯¹
    result.push(
      leftTemp[0] < rightTemp[0] ? leftTemp.shift() : rightTemp.shift(),
    ), // æ’åºäº¤æ¢æ•°æ®
      cum.cum++; // è®¡æ•°å™¨è‡ªå¢
  arr = result.concat(leftTemp).concat(rightTemp); // ç»™æ•°ç»„å¤åˆ¶
  return [cum.cum, arr]; // è¿”å›è®¡æ•°å™¨å’Œæ•°ç»„
}

/** å¿«é€Ÿæ’åº
 *
 *  æ¯æ¬¡å°†æ•°ç»„ä»¥ç‰¹å®šå…ƒç´ åˆ†å¼€
 *  åˆ†æˆä¸¤éƒ¨åˆ† ï¼ˆç›¸å½“äºæŠŠè¿™ä¸ªå€¼æ”¾åˆ°äº†æ­£ç¡®ä½ç½®ï¼‰
 *  ä¸‹æ¬¡ä»¥å·¦å³ç»§ç»­å¼€å§‹
 */
function quickSortFunction(arr: any, asc: boolean = true) {
  const cum = { cum: 0 };
  const _sort = (
    arr: any,
    left: number = 0,
    right: number = arr.length - 1,
  ) => {
    if (left >= right) return; //å¦‚æœå·¦è¾¹çš„ç´¢å¼•å¤§äºç­‰äºå³è¾¹çš„ç´¢å¼•è¯´æ˜æ•´ç†å®Œæ¯•
    let i = left,
      j = right;
    const baseVal = arr[j]; // å–æ— åºæ•°ç»„æœ€åä¸€ä¸ªæ•°ä¸ºåŸºå‡†å€¼
    while (i < j) {
      //æŠŠæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„æ•°æ”¾åœ¨å·¦è¾¹å¤§çš„æ•°æ”¾åœ¨å³è¾¹
      while (
        i < j &&
        ((asc && arr[i] <= baseVal) || (!asc && arr[i] >= baseVal))
      )
        i++; //æ‰¾åˆ°ä¸€ä¸ªæ¯”åŸºå‡†å€¼å¤§çš„æ•°äº¤æ¢
      (arr[j] = arr[i]), cum.cum++; // å°†è¾ƒå¤§çš„å€¼æ”¾åœ¨å³è¾¹å¦‚æœæ²¡æœ‰æ¯”åŸºå‡†å€¼å¤§çš„æ•°å°±æ˜¯å°†è‡ªå·±èµ‹å€¼ç»™è‡ªå·±ï¼ˆi ç­‰äº jï¼‰
      while (
        j > i &&
        ((asc && arr[j] >= baseVal) || (!asc && arr[i] <= baseVal))
      )
        j--; //æ‰¾åˆ°ä¸€ä¸ªæ¯”åŸºå‡†å€¼å°çš„æ•°äº¤æ¢
      (arr[i] = arr[j]), cum.cum++; // å°†è¾ƒå°çš„å€¼æ”¾åœ¨å·¦è¾¹å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ¯”åŸºå‡†å€¼å°çš„æ•°å°±æ˜¯å°†è‡ªå·±èµ‹å€¼ç»™è‡ªå·±ï¼ˆi ç­‰äº jï¼‰
    }
    arr[j] = baseVal; // å°†åŸºå‡†å€¼æ”¾è‡³ä¸­å¤®ä½ç½®å®Œæˆä¸€æ¬¡å¾ªç¯ï¼ˆè¿™æ—¶å€™ j ç­‰äº i ï¼‰
    cum.cum++;
    _sort(arr, left, j - 1); // å°†å·¦è¾¹çš„æ— åºæ•°ç»„é‡å¤ä¸Šé¢çš„æ“ä½œ
    _sort(arr, j + 1, right); // å°†å³è¾¹çš„æ— åºæ•°ç»„é‡å¤ä¸Šé¢çš„æ“ä½œ
  };

  //  arr.concat() // ä¸ºäº†ä¿è¯è¿™ä¸ªå‡½æ•°æ˜¯çº¯å‡½æ•°æ‹·è´ä¸€æ¬¡æ•°ç»„
  _sort(arr);
  return [cum.cum, arr];
}

/** å†’æ³¡æ’åº
 *   æ¯æ¬¡å°†æœ€å¤§çš„æ‹åˆ°æœ€å‰
 *   æˆ–å°†æœ€å°çš„æ”¾åˆ°æœ€å
 */
function bubbleSortFunction(arr: any, asc: boolean = true) {
  let length = arr.length + 1,
    cum = 0; // å®šä¹‰ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„é•¿åº¦ï¼Œä¸€ä¸ªæ˜¯
  while (--length)
    // ä»æœ€é•¿å¼€å§‹
    for (
      let j = 0;
      j < length;
      j++ // æ¯”è¾ƒæ¯ä¸€è½®
    )
      if ((asc && arr[j] > arr[j + 1]) || (!asc && arr[j] < arr[j + 1]))
        // å¦‚æœå¤§å°±æ”¾åé¢ï¼Œä¸€è½®ç»“æŸ
        ([arr[j], arr[j + 1]] = [arr[j + 1], arr[j]]), cum++;
  return cum;
}
/** é€‰æ‹©æ’åº */
function selectSortFunction(arr: any, asc: boolean = true) {
  let cum = 0,
    length = arr.length; // å®šä¹‰è®¡æ•°å™¨
  if (length < 2) return cum;
  for (let i = 0; i < length; i++) {
    let minIndex = i; // å‡è®¾å½“å‰ä¸ºæœ€å°å€¼ä¸‹æ ‡
    for (let j = i + 1; j < length; j++)
      if ((asc && arr[minIndex] > arr[j]) || (!asc && arr[minIndex] < arr[j]))
        // å¦‚æœæœ‰æ–°çš„æœ€å°å€¼ï¼Œå°†é‡åˆ¶æœ€å°å€¼ä¸‹æ ‡
        minIndex = j;
    if (i != minIndex)
      ([arr[i], arr[minIndex]] = [arr[minIndex], arr[i]]), cum++; // å¦‚æœä¸¤ä¸ªå€¼ä¸æƒ³ç­‰åˆ™äº¤æ¢ä½ç½®
  }
  return cum;
}

/**  åŸºæ•°æ’åº
 *  å°†æ•°æ®æ”¾å…¥å¯¹åº”çš„æ¡¶å†…ï¼Œç„¶åç›´æ¥ä½¿ç”¨ concent è¿æ¥
 */
function radixSortFunction(arr: any) {
  let cum = 0,
    length = arr.length - 1,
    minEle = arr[0],
    maxEle = arr[length],
    minEleLength = 0,
    maxEleLength;
  if (length < 1) return cum; // ä»…æœ‰ä¸€ä¸ªå…ƒç´ æˆ–æ²¡æœ‰å…ƒç´ åˆ™ç›´æ¥è¿”å›
  for (let i of arr) {
    if (i) {
      if (i < minEle)
        minEle = i; // æ‰¾å‡ºæœ€å°å€¼
      else if (i > maxEle) maxEle = i; // æ‰¾åˆ°æœ€å¤§å€¼
    }
  }
  if (minEle == maxEle) return cum; // å¦‚æœæ•°ç»„å†…æ‰€æœ‰çš„å€¼éƒ½ç›¸ç­‰
  minEleLength = minEle.toString().length; // åˆå§‹åŒ–æœ€å°å€¼é•¿åº¦
  maxEleLength = maxEle.toString().length; // åˆå§‹åŒ–æœ€å¤§å€¼é•¿åº¦

  const _sort = (arr: any, digit: number) => {
    const _tempArr: any = []; // è®¾å®šä¸´æ—¶é•¿åº¦çš„
    let _result: any = []; // ç»“æœæ•°ç»„
    for (let i = 10; i--; ) _tempArr.push([]); // åˆå§‹åŒ–ä¸´æ—¶æ•°ç»„
    for (let i of arr) _tempArr[_getNum(i, digit)].push(i); //æ”¾å…¥å¯¹åº”çš„ ğŸª£ ä¸­
    for (let i = 0; i < 10; i++) _result = _result.concat(_tempArr[i]); // å°† ğŸª£ ä¸­æ•°æ®é‡æ–°è£…èµ·æ¥
    return _result.concat(); // å°†å€¼ç»™ç»“æœ
  };
  const _getNum = (num: number, digit: number) =>
    Number(num.toString().split('').reverse()[digit - 1]) || 0; // è·å–æŒ‡å®šä½æ•°çš„æ•°å€¼
  for (let i = minEleLength; i <= maxEleLength; i++)
    (arr = _sort(arr, i)), // æ’åº
      cum++; // è®¡æ•°å™¨è‡ªå¢
  return cum;
}

/** å †æ’åº */
function heapSortFunction(arr: any, asc: boolean = true) {
  let length = arr.length, // æ•°ç»„é•¿åº¦
    index = length - 1, // æ•°ç»„æœ€å¤§ä¸‹æ ‡
    cum = 0; //è®¡æ•°å™¨
  for (
    let k = Math.floor(length / 2);
    k >= 0;
    --k // åˆ›å»ºå †
  )
    _sink(arr, k, index); // å°æ•°å­—ä¸‹æ²‰ï¼ˆåæ’ï¼‰
  while (index) {
    // å¼€å§‹æ’åº
    [arr[0], arr[index]] = [arr[index], arr[0]]; // äº¤æ¢å…ƒç´ ï¼Œå°†æœ€å€¼å…ƒç´ æ”¾ç½®æœ«ç«¯
    _sink(arr, 0, --index); // å°æ•°å­—ä¸‹æ²‰ï¼ˆåæ’ï¼‰
  }
  function _sink(arr: any, low: number, high: number) {
    // ä» low å¼€å§‹æŸ¥æ‰¾å­èŠ‚ç‚¹
    while (low * 2 + 1 <= high) {
      // å½“æœ¬æ¬¡æ¯”å¯¹æ•°ç»„ä¸­æœ€å°ä¸‹æ ‡æ»¡è¶³å°é›¨æœ€å¤§ä¸‹æ ‡ä¸€åŠæ—¶
      let j: any = low * 2 + 1; // è·å– low å¾—ç›´æ¥å·¦å­èŠ‚ç‚¹
      cum++;
      if (asc) {
        if (j < high && arr[j] < arr[j + 1]) j++; // åˆ¤æ–­  low ä½ç½®ä¸­å­èŠ‚ç‚¹ä¸­è¾ƒå¤§çš„å­èŠ‚ç‚¹
        if (arr[low] > arr[j]) break;
      } else {
        if (j < high && arr[j] > arr[j + 1]) j++; // åˆ¤æ–­  low ä½ç½®ä¸­å­èŠ‚ç‚¹ä¸­è¾ƒå¤§çš„å­èŠ‚ç‚¹
        if (arr[low] < arr[j]) break;
      }
      [arr[low], arr[j]] = [arr[j], arr[low]]; // äº¤æ¢ low èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„å€¼
      low = j; // ç»§ç»­æ’æŸ¥ä¸‹æ²‰åæ˜¯å¦éœ€è¦ç»§ç»­ä¸‹æ²‰
    }
  }
  return [cum, arr];
}

// è®¡æ•°æ’åº
function countSortFunction(arr: any, asc: boolean = true) {
  let cum = 0;
  const result: any = [];
  for (let i = 0, j = arr.length; i < j; i++) {
    // å¼€å§‹è®¡æ•°
    let m = arr.pop();
    cum++;
    result[m] = result[m] ? result[m] + 1 : 1;
  }
  for (const i in result) {
    let j = result[i];
    while (j--) arr.push(i), cum++; // æ”¾ç½®æ•°æ®
  }
  return cum;
}

/** æ»šåŠ¨åˆ°é¡¶éƒ¨
 *
 * Ele æ»šåŠ¨å…ƒç´ 
 *
 * top æ»šåŠ¨åˆ°ä½ç½®
 *
 *
 */
function scrollToTop(Ele: any, top: number = 0) {
  const step = Math.abs((Ele.current as any).scrollTop - top) / 15;
  const up = (Ele.current as any).scrollTop - top > 0;
  const __scroll = () => {
    setTimeout(() => {
      if ((Ele.current as any).scrollTop - top > 0 && up) {
        (Ele.current as any).scrollTop -= step;
        __scroll();
      } else if ((Ele.current as any).scrollTop - top < 0 && !up) {
        (Ele.current as any).scrollTop += step;
        __scroll();
      } else (Ele.current as any).scrollTop = top;
    }, 10);
  };
  __scroll();
}

function getQuery(str: string) {
  const res: { [x: string]: string | number | boolean } = {};
  if (str.length < 2) return res;
  str = decodeURIComponent(str.slice(1));
  const arr = str.split('&');
  for (const i in arr) {
    const j = arr[i].split('=');
    res[j[0]] = j[1];
  }
  return res;
}

export {
  insertSortFunction,
  shellSortFunction,
  mergeSortFunction,
  quickSortFunction,
  bubbleSortFunction,
  selectSortFunction,
  radixSortFunction,
  heapSortFunction,
  countSortFunction,
  scrollToTop,
  getQuery,
};
export const { copyText, tendTiZero } = fn;
export default fn;
